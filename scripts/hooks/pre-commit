#!/bin/bash
# Pre-commit hook: Run code quality checks before allowing commit

set -e

echo "ğŸ” Running pre-commit checks..."

# Run ruff linting
echo "  â†’ ruff check..."
if ! uv run ruff check src/ packages/ 2>/dev/null; then
    echo "âŒ ruff check failed. Fix errors before committing."
    exit 1
fi

# Run ruff format check
echo "  â†’ ruff format --check..."
if ! uv run ruff format --check src/ packages/ 2>/dev/null; then
    echo "âŒ ruff format check failed. Run 'uv run ruff format src/ packages/' to fix."
    exit 1
fi

# Run mypy type checks
echo "  â†’ mypy..."
if ! uv run mypy src/python/htmlgraph/ --ignore-missing-imports 2>/dev/null; then
    echo "âŒ mypy check failed. Fix type errors before committing."
    exit 1
fi

echo "âœ… All pre-commit checks passed!"
