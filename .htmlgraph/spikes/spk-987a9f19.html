<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="htmlgraph-version" content="1.0">
    <title>Research: Template Systems for Docs</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <article id="spk-987a9f19"
             data-type="spike"
             data-status="todo"
             data-priority="medium"
             data-created="2026-01-02T12:04:09.450273"
             data-updated="2026-01-02T12:04:09.450276" data-spike-type="general" data-timebox-hours="4">

        <header>
            <h1>Research: Template Systems for Docs</h1>
            <div class="metadata">
                <span class="badge status-todo">Todo</span>
                <span class="badge priority-medium">Medium Priority</span>
            </div>
        </header>

    
        <section data-spike-metadata>
            <h3>Spike Metadata</h3>
            <dl>
                <dt>Type</dt>
                <dd>General</dd>
                <dt>Timebox</dt>
                <dd>4 hours</dd>
            </dl>
        </section>
        <section data-findings>
            <h3>Findings</h3>
            <div class="findings-content">
                
# Template Systems Research for Documentation Generation

## Executive Summary

**Recommendation: Jinja2** for HtmlGraph agent documentation generation with user customization support.

**Runner-up: YAML Frontmatter + Jinja2** for maximum flexibility and separation of metadata from content.

---

## Detailed Comparison

### 1. Jinja2 (Python)

**Overview:**
- Industry-standard templating engine for Python
- Compiles templates to optimized Python bytecode
- Rich feature set: inheritance, macros, filters, control structures
- Already installed in HtmlGraph project

**Pros:**
âœ… **Powerful inheritance system** - Template blocks can be overridden by users  
âœ… **Custom filters/functions** - Extend with domain-specific formatting  
âœ… **Well-documented** - Extensive docs, large community  
âœ… **Performance** - Compiled templates, cached execution  
âœ… **Separation of concerns** - Logic separate from presentation  
âœ… **Already a dependency** - No new packages needed  

**Cons:**
âŒ **Limited Python in templates** - Can't use arbitrary Python code (by design)  
âŒ **Learning curve** - More complex than simple string substitution  
âŒ **Template complexity** - Can become hard to maintain if logic grows  

**Code Example:**
```python
from jinja2 import Template, Environment, FileSystemLoader

# Simple inline template
template = Template('''
# {{ agent.name }} Agent
**Type:** {{ agent.type }}
{{ agent.description }}
''')

# File-based with inheritance
env = Environment(loader=FileSystemLoader('templates/'))
base = env.get_template('agent_base.md')
output = base.render(agent=agent_data)
```

**User Customization Pattern:**
```python
# Base template (package-provided)
# templates/agent_base.md
{% block header %}
# {{ agent.name }} Agent
{% endblock %}

{% block content %}
{{ agent.description }}
{% endblock %}

# User override (user-provided)
# ~/.htmlgraph/templates/agent_custom.md
{% extends "agent_base.md" %}
{% block header %}
# ðŸ¤– {{ agent.name }} - Custom Header
{% endblock %}
```

**Verdict:** â­â­â­â­â­ (5/5) - Best overall choice

---

### 2. Mustache (Logic-less)

**Overview:**
- Language-agnostic, logic-less templating
- Available in many languages (Python: pystache)
- Simple syntax: {{variable}}, {{#list}}...{{/list}}

**Pros:**
âœ… **Simplicity** - Minimal syntax, easy to learn  
âœ… **Language-portable** - Same templates work across languages  
âœ… **Forced separation** - No logic in templates (enforced)  
âœ… **Easy testing** - Templates testable in isolation  
âœ… **Designer-friendly** - Non-programmers can edit  

**Cons:**
âŒ **Limited functionality** - No conditionals, limited loops  
âŒ **Logic must go elsewhere** - Requires additional view layer  
âŒ **Less flexible** - Can't handle complex formatting  
âŒ **Extra dependency** - Needs pystache package  
âŒ **No inheritance** - Template reuse is limited  

**Code Example:**
```python
import pystache

template = '''
# {{name}} Agent
{{#commands}}
- {{.}}
{{/commands}}
'''

data = {
    'name': 'Explorer',
    'commands': ['cmd1', 'cmd2']
}

output = pystache.render(template, data)
```

**Verdict:** â­â­â­ (3/5) - Too restrictive for complex docs

---

### 3. Python string.Template (Built-in)

**Overview:**
- Part of Python standard library
- Simple $variable or ${variable} substitution
- PEP 292 specification

**Pros:**
âœ… **Zero dependencies** - Built into Python  
âœ… **Simple** - Minimal API surface  
âœ… **Fast** - No compilation overhead  
âœ… **Safe** - Limited execution, no code injection risk  

**Cons:**
âŒ **Very limited** - Only variable substitution  
âŒ **No loops/conditionals** - Can't iterate or branch  
âŒ **No inheritance** - No template reuse  
âŒ **No filters** - Can't format values  
âŒ **Poor error messages** - Missing variables fail silently or raise KeyError  

**Code Example:**
```python
from string import Template

template = Template('''
# $name Agent
Type: $type
''')

output = template.substitute(name='Explorer', type='Research')
# or .safe_substitute() for missing keys
```

**Verdict:** â­â­ (2/5) - Only for trivial use cases

---

### 4. YAML Frontmatter + Markdown

**Overview:**
- Metadata in YAML block at top of file
- Content in Markdown body
- Used by Jekyll, Hugo, Obsidian, etc.

**Pros:**
âœ… **Separation of metadata and content** - Clear structure  
âœ… **Version control friendly** - Text-based, good diffs  
âœ… **Human-readable** - Easy to edit manually  
âœ… **Standards-based** - YAML + Markdown are widely known  
âœ… **Flexible** - Can combine with any template engine for body  
âœ… **User-editable** - Non-programmers can modify metadata  

**Cons:**
âŒ **Not a template engine itself** - Needs Jinja2/etc for body  
âŒ **Manual parsing required** - Need to split frontmatter from body  
âŒ **YAML quirks** - Indentation-sensitive, type coercion surprises  

**Code Example:**
```python
import yaml

doc = '''---
name: Explorer
type: Research
version: 1.0
---
# {{ name }} Agent
Searches codebases.
'''

# Parse
parts = doc.split('---', 2)
metadata = yaml.safe_load(parts[1])
body = parts[2].strip()

# Render body with Jinja2
from jinja2 import Template
output = Template(body).render(**metadata)
```

**User Customization Pattern:**
```yaml
---
# Package default
name: Explorer
type: Research

# User can add custom fields
custom_icon: ðŸ”
custom_color: blue
---
```

**Verdict:** â­â­â­â­ (4/5) - Excellent for user customization

---

### 5. Mako (Alternative)

**Overview:**
- Python-based, similar to Jinja2
- Used by Reddit, Pylons, Pyramid
- Compiles to Python bytecode

**Pros:**
âœ… **Performance** - Slightly faster than Jinja2  
âœ… **Full Python support** - Embed arbitrary Python code  
âœ… **Dynamic inheritance** - More flexible than Jinja2  

**Cons:**
âŒ **Extra dependency** - Not installed in HtmlGraph  
âŒ **Less popular** - Smaller community than Jinja2  
âŒ **Security concerns** - Arbitrary Python execution can be risky  
âŒ **Syntax** - More angle brackets, less readable for HTML/Markdown  

**Verdict:** â­â­â­ (3/5) - Overkill for our use case

---

## Comparison Table

| Feature | Jinja2 | Mustache | string.Template | YAML+Jinja2 | Mako |
|---------|--------|----------|-----------------|-------------|------|
| **Ease of use** | Medium | High | Very High | Medium | Medium |
| **User customization** | Excellent | Poor | None | Excellent | Excellent |
| **Dependencies** | âœ… Installed | âŒ New | âœ… Built-in | âœ… Installed | âŒ New |
| **Inheritance** | âœ… Yes | âŒ No | âŒ No | âš ï¸ Via Jinja2 | âœ… Yes |
| **Loops/Conditionals** | âœ… Yes | âš ï¸ Limited | âŒ No | âœ… Via Jinja2 | âœ… Yes |
| **Custom filters** | âœ… Yes | âŒ No | âŒ No | âœ… Via Jinja2 | âœ… Yes |
| **Error messages** | Good | Fair | Poor | Good | Good |
| **Version control** | Good | Good | Good | Excellent | Good |
| **Documentation** | Excellent | Good | Fair | Good | Good |
| **Performance** | High | Medium | Very High | High | Very High |

---

## Recommendation

### Primary: Jinja2

**Why:**
1. âœ… Already installed - no new dependencies
2. âœ… Template inheritance - users can override sections
3. âœ… Custom filters - domain-specific formatting
4. âœ… Industry standard - well-documented, large community
5. âœ… Good error messages - helps users debug templates

**Use cases:**
- Agent documentation generation
- Email templates for notifications
- Report generation
- Configuration file templates

**Implementation pattern for HtmlGraph:**
```python
# htmlgraph/templates/agent.md (package default)
{% extends "base.md" if user_template_exists else "default_base.md" %}

{% block header %}
# {{ agent.name }} Agent
{% endblock %}

{% block description %}
{{ agent.description }}
{% endblock %}

{% block usage %}
## Usage
{% for cmd in agent.commands %}
- `{{ cmd }}`
{% endfor %}
{% endblock %}

# User can override in ~/.htmlgraph/templates/agent.md
{% extends "htmlgraph::agent.md" %}
{% block header %}
# ðŸ¤– {{ agent.name }} - My Custom Agent
{% endblock %}
```

### Secondary: YAML Frontmatter + Jinja2

**Why:**
1. âœ… Best separation of metadata and content
2. âœ… User-friendly editing (non-programmers can edit YAML)
3. âœ… Version control excellence (good diffs)
4. âœ… Standards-based (Jekyll/Hugo/Obsidian pattern)

**Use cases:**
- When users need to customize metadata extensively
- When content and structure should be clearly separated
- When templates are user-facing and edited frequently

**Implementation pattern:**
```python
def load_template_with_frontmatter(path):
    with open(path) as f:
        content = f.read()
    
    parts = content.split('---', 2)
    metadata = yaml.safe_load(parts[1]) if len(parts) >= 3 else {}
    body = parts[2].strip() if len(parts) >= 3 else content
    
    # Merge user metadata with defaults
    final_metadata = {**default_metadata, **metadata}
    
    # Render body with Jinja2
    template = Template(body)
    return template.render(**final_metadata)
```

---

## Sources

Research based on:
- [Jinja2 for Documentation Generation (GeeksforGeeks)](https://www.geeksforgeeks.org/python/how-to-use-jinja-for-document-generation/)
- [Jinja2 Official Documentation](https://jinja.palletsprojects.com/)
- [Mustache Logic-less Templates](https://mustache.github.io/mustache.5.html)
- [What are the benefits of logic-less templates like Mustache? (Quora)](https://www.quora.com/What-are-the-benefits-of-logic-less-templates-like-Mustache)
- [Python Template Engine Comparison (Armin Ronacher)](https://lucumr.pocoo.org/2008/1/1/python-template-engine-comparison/)
- [3 Python template libraries compared (Opensource.com)](https://opensource.com/resources/python/template-libraries)
- [Python Template Libraries for Code Generation](https://www.pythontutorials.net/blog/best-python-templating-library-to-facilitate-code-generation/)
- [YAML Frontmatter (GitHub Docs)](https://docs.github.com/en/contributing/writing-for-github-docs/using-yaml-frontmatter)
- [Using Frontmatter in Markdown](https://www.markdownlang.com/advanced/frontmatter.html)
- [Jekyll Front Matter Documentation](https://jekyllrb.com/docs/front-matter/)

            </div>
        </section>
    </article>
</body>
</html>
