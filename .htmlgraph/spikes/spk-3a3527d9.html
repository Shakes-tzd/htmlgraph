<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="htmlgraph-version" content="1.0">
    <title>Dashboard Events Not Appearing - Critical Investigation</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <article id="spk-3a3527d9"
             data-type="spike"
             data-status="todo"
             data-priority="medium"
             data-created="2026-01-08T11:48:51.612191"
             data-updated="2026-01-08T11:48:51.612196" data-spike-type="general" data-timebox-hours="4" data-agent-assigned="claude-code">

        <header>
            <h1>Dashboard Events Not Appearing - Critical Investigation</h1>
            <div class="metadata">
                <span class="badge status-todo">Todo</span>
                <span class="badge priority-medium">Medium Priority</span>
            </div>
        </header>

    
        <section data-spike-metadata>
            <h3>Spike Metadata</h3>
            <dl>
                <dt>Type</dt>
                <dd>General</dd>
                <dt>Timebox</dt>
                <dd>4 hours</dd>
            </dl>
        </section>
        <section data-findings>
            <h3>Findings</h3>
            <div class="findings-content">
                ## Issue Summary
Dashboard shows 0 events despite successful event capture in prior testing.

**Evidence of Working System:**
- Manual test: Event evt-703e699d captured to database
- API test: /api/events returned event in JSON response
- Schema: All database fixes applied (agent_events table, correct columns)
- System: All code changes deployed and functional

**Current Problem:**
- User reports: "none of the event are showing up on the dashboard"
- Dashboard UI shows 0 events
- **Contradiction**: API worked in test, but now dashboard empty

## Investigation Checklist
- [ ] Verify /api/events endpoint returns events (curl test)
- [ ] Check dashboard is reading from correct database
- [ ] Verify PreToolUse hook fires on REAL tool execution (not just manual test)
- [ ] Check browser console for JavaScript errors
- [ ] Verify WebSocket connection (/ws/events) is active
- [ ] Compare event count: API vs database vs dashboard
- [ ] Check if dashboard cache needs refresh
- [ ] Verify session ID is being captured in recent events

## Root Cause Hypotheses
1. **WebSocket Staleness**: WebSocket connection established before events were inserted
2. **Database Instance Mismatch**: Hook inserting to different database than dashboard reads
3. **Frontend Cache**: Dashboard caching old data, needs browser refresh
4. **Hook Not Firing**: Assumption that hook works based on manual test; hasn't tested with real Claude Code tool
5. **Session ID Issue**: Events captured but with wrong session ID, filtered out
            </div>
        </section>
    </article>
</body>
</html>
